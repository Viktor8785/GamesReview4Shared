import{gamesData}from"./games-data.js";const mediaQueryMobileOnly=window.matchMedia("(max-width: 719px"),mediaQueryTabletOnly=window.matchMedia("(min-width: 720px)"),pageBody=document.querySelector(".page__body"),gameImg1=document.querySelector("#img1"),gameImg2=document.querySelector("#img2"),gameImg3=document.querySelector("#img3"),cardContainer=document.querySelector(".game__card-container"),gameName=document.querySelector(".game__name"),gameGenre=document.querySelector(".game__genre"),gameRating=document.querySelector(".game__img-rating"),gameText=document.querySelector(".game__text"),buttonBack=document.querySelector(".game__button-back"),span2=document.querySelector(".game__span2"),buttonWatchlist=document.querySelector(".game__button-watchlist"),buttonWish=document.querySelector(".game__button-wish"),buttonLeft=document.querySelector(".game__button-left"),buttonRight=document.querySelector(".game__button-right"),watchButton=document.querySelector("#watch-button"),loadButton=document.querySelector("#load-button");let urlParams=new URLSearchParams(window.location.search),param=urlParams.get("param"),param2=urlParams.get("param2"),game=gamesData.find((e=>e.id==param)),currentIndex=0,leftXMax=-374,leftXs=[],leftX=0;pageBody.style.minHeight=window.innerHeight+"px",span2.textContent="Back";for(let e=0;e<3;e++)leftXs[e]=leftXMax*e;cardContainer.style.left=0;let watchList=localStorage.getItem("wish"),watchListFlag=!1;function makeImageLink(){const e=document.createElement("canvas"),t=e.getContext("2d"),a=new Image;let n="";switch(currentIndex){case 0:n=game.imgFile+"1.jpg";break;case 1:n=game.imgFile+"2.jpg";break;case 2:n=game.imgFile+"3.jpg"}a.onload=function(){e.width=a.width,e.height=a.height,t.drawImage(a,0,0),loadButton.href=e.toDataURL("image/jpeg"),loadButton.download="image.jpg"},a.src=n}function handleWidthChangeTablet(e){e.matches&&(leftXMax=-600,startSettings())}function handleWidthChangeMobile(e){e.matches&&(leftXMax=window.innerWidth,leftXMax>430&&(leftXMax=430),leftXMax*=-1,startSettings())}function startSettings(){currentIndex=0;for(let e=0;e<3;e++)leftXs[e]=leftXMax*e;leftX=0,cardContainer.style.left=0}watchList&&watchList.indexOf(param)>=0&&(buttonWish.classList.add("game__button-wish--active"),watchListFlag=!0),gameImg1.src=game.imgFile+"1.jpg",gameImg1.alt=game.name,gameImg2.src=game.imgFile+"2.jpg",gameImg2.alt=game.name,gameImg3.src=game.imgFile+"3.jpg",gameImg3.alt=game.name,gameName.textContent=game.name,gameGenre.textContent=game.genre,gameRating.textContent=game.rating,gameText.textContent=game.text,handleWidthChangeMobile(mediaQueryMobileOnly),handleWidthChangeTablet(mediaQueryTabletOnly),makeImageLink(),buttonBack.addEventListener("click",(()=>{param2?window.location.href="home"==param2?"index.html":"games.html?param=watch":window.history.go(-1)})),buttonWatchlist.addEventListener("click",(()=>{buttonWish.classList.toggle("game__button-wish--active"),watchList=localStorage.getItem("wish");let e="";if(watchListFlag)if(watchListFlag=!1,3==watchList.length)e="";else{let t=watchList.indexOf(param);0==t&&(e=watchList.slice(watchList.indexOf(param)+3)),t==watchList.length-3&&(e=watchList.slice(0,watchList.indexOf(param))),t>0&&t<watchList.length-3&&(e=watchList.slice(0,watchList.indexOf(param))+watchList.slice(watchList.indexOf(param)+3))}else e=param+" ",watchList&&watchList.length>0&&(e=watchList+param+" "),watchListFlag=!0;localStorage.setItem("wish",e)})),buttonLeft.addEventListener("click",(()=>{currentIndex>0&&(currentIndex--,leftX=leftXs[currentIndex],cardContainer.style.left=leftX+"px",makeImageLink())})),buttonRight.addEventListener("click",(()=>{currentIndex<2&&(currentIndex++,leftX=leftXs[currentIndex],cardContainer.style.left=leftX+"px",makeImageLink())})),watchButton.addEventListener("click",(()=>{watchButton.href="games.html?param=watch"})),mediaQueryTabletOnly.addEventListener("change",handleWidthChangeTablet),mediaQueryMobileOnly.addEventListener("change",handleWidthChangeMobile);